from pathlib import Path


# ======================================================================
# configuration files
# ======================================================================

# Default to using the config file in the same respository as this 
# Snakefile. Alternatively, you can specify a different config file
# via commandline option `--configfile <path/to/config.yaml>`.
configfile: workflow.source_path('../config/config.yaml')




# ======================================================================
# rules
# ======================================================================


#
# these won't be submitted as jobs to the scheduler
#
localrules:
    all,
    all_split_channels,
    all_segment_nuclei,
    all_piv,
    draw_roi,
    crop_roi,
    split_channels,
    gen_piv_config_json,



include: "rules/common.smk"
include: "rules/resources.smk"
include: "rules/roi.smk"
include: "rules/segmentation.smk"
include: "rules/piv.smk"
include: "rules/normalize_and_msnd.smk"


# -------------------------------------
# the default target rule
# -------------------------------------
rule all:
    input:
        ".all_piv",
        ".all_segment_nuclei",
    default_target: True


# -------------------------------------
# rules that require internet access
# -------------------------------------
rule all_resources:
    input:
        all_resources_input


# -------------------------------------
# other "all" rules for target
# -------------------------------------
rule all_roi:
    input:
        all_roi_input

rule all_segmentation:
    input:
        all_segmentation_input

rule all_piv:
    input:
        all_piv_input

rule all_normalize_and_msnd:
    input:
        all_normalize_and_msnd_input
